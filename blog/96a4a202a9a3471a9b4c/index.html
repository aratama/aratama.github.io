<!DOCTYPE html><html lang="ja"><head><meta charset="UTF-8"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@cubbit2"><meta name="twitter:creator" content="@cubbit2"><meta name="twitter:title" content="【翻訳】なぜPureScriptを使うべきなのか - ちょっと小さいのはたしかですが。"><meta name="twitter:description" content="【翻訳】なぜPureScriptを使うべきなのか"><meta name="twitter:image" content="https://aratama.github.io/blog/96a4a202a9a3471a9b4c/thumbnail.jpg"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" href="icon.png"><link rel="stylesheet" href="/res/reset.css"><link rel="stylesheet" href="/res/style.css"><title>【翻訳】なぜPureScriptを使うべきなのか - ちょっと小さいのはたしかですが。</title><script>
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

                ga('create', 'UA-61162129-3', 'auto');
                ga('send', 'pageview');
            </script></head><body><header><div class="sns"><a target="_blank" href="https://twitter.com/intent/tweet?text=undefined%20https%3A%2F%2Faratama.github.io%2Fblog%2F96a4a202a9a3471a9b4c"><img src="/res/twitter.png" alt="twitter button"></a><a target="brank" href="http://www.facebook.com/sharer.php?u=https%3A%2F%2Faratama.github.io%2Fblog%2F96a4a202a9a3471a9b4c&amp;t=undefined"><img src="/res/facebook.png" alt="facebook button"></a><a target="brank" href="https://plus.google.com/share?url=https%3A%2F%2Faratama.github.io%2Fblog%2F96a4a202a9a3471a9b4c"><img src="/res/google.png" alt="google plus button"></a><a target="brank" href="http://b.hatena.ne.jp/entry/https%3A%2F%2Faratama.github.io%2Fblog%2F96a4a202a9a3471a9b4c"><img src="/res/hatena.png" alt="hatena bookmark button"></a><a target="brank" href="http://getpocket.com/edit?url=https%3A%2F%2Faratama.github.io%2Fblog%2F96a4a202a9a3471a9b4c&amp;title=undefined"><img src="/res/pocket.png" alt="pocket button"></a></div><div class="block-centered"><div class="site-title"><a href="/">Admittedly <wbr>something <wbr>small.</a></div><div class="sub-title">ちょっと<wbr>小さいのは<wbr>たしかですが。</div></div></header><div class="content"><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"><link rel="stylesheet" href="/res/article.css"><article id="rendered"><div class="date">2017年8月17日</div><h1 class="article-title"><a href=".">【翻訳】なぜPureScriptを使うべきなのか</a></h1><p class="tags"><a href="/blog/tag/JavaScript"><span class="tag"><i class="fa fa-tag"></i>JavaScript</span></a><a href="/blog/tag/purescript"><span class="tag"><i class="fa fa-tag"></i>purescript</span></a><a href="/blog/tag/関数型プログラミング"><span class="tag"><i class="fa fa-tag"></i>関数型プログラミング</span></a></p><hr><div><p>この記事は<a href="https://gist.github.com/paf31/adfd15fbb1ac8b99fc68be2c9aca8427">Phil Freeman, &quot;Why You Should Use PureScript&quot;</a>の邦訳です。この記事の原著者のフィルさんは、PureScriptのオリジナルの作者さんでもあります。原著は<a href="https://creativecommons.org/licenses/by-nc-sa/3.0/">CC BY-NC-SA 3.0</a>でライセンスされており、その許諾に従って私が勝手に翻訳・公開するものです。もし翻訳された内容に誤りなどがあれば、修正しますので私までご連絡ください。また、わりとざっくりした記事なので、HaskellやPureScriptについて知識がないとわかりにくい部分もあるかもしれませんが、ご了承ください。これは私の夏休みの自由研究です。みなさんも夏休みの自由研究にPureScriptはいかがでしょうか。</p>
<hr />
<h1>なぜPureScriptを使うべきか</h1>
<h2>優れた抽象</h2>
<p>PureScriptは『型クラス』を持ち、私たちはこれを使って<strong>とても</strong>再利用性の高いコードを書いています。PureScriptを使って記述量を減らし、コードの再利用性を更に高めることができます。</p>
<p>あなたは自分が型クラスのない言語で今まで何度<a href="https://pursuit.purescript.org/packages/purescript-foldable-traversable/3.4.0/docs/Data.Traversable#t:Traversable"><code>traverse</code></a>を書いてきたと思いますか？<code>traverse</code>の実装はNPMライブラリ全体で一度だけされていれば十分です。以下のすべてが同じ<code>Traversable</code>インスタンスによって実現されます。</p>
<ul>
<li>リストに入ったAJAXリクエストすべての完了を待つ</li>
<li>リストに入った複数のフォームフィールドを検証する</li>
<li>リストに入ったNullになりうる値について、すべてがNullでないことを確認する</li>
<li>リストに入った複数の値があり、それらに何らかの関数を適用したときの値のうち、最大のものを探索する</li>
</ul>
<p>ここでもし私が『リスト』という単語を、『ストリーム』、『配列』、『木』のどれかに置き換えたとしても、同じように<code>traverse</code>を使い続けることができます。これらの構造はすべて、同じ型クラスを実装しているからです！</p>
<p>高カインド多相(higher kinded polymorphism)や型クラスがない言語では、コンテナと<code>Applicative</code>の組み合わせにそれぞれについて、毎回<code>traverse</code>を書かなくてはなりません。いったい幾つの関数を書くことになるのでしょう！　PureScriptではその代わりに、それぞれのコンテナについて<code>traverse</code>を一度だけ書き、型クラスを使って形式的に扱います。</p>
<p>優れた抽象は、より一般的な手段を表現し、概念を抽象的に説明できるようにもします。</p>
<h2>優れたライブラリ</h2>
<p><a href="https://pursuit.purescript.org/">Pursuit</a>は、あらゆる種類の開発で役に立つ、大量のPureScriptライブラリのドキュメントをホストしています。</p>
<ul>
<li>シングルページアプリケーション</li>
<li>ウェブサービス</li>
<li>サーバサイドレンダリング</li>
<li>データベースアプリケーション</li>
<li>モバイル開発</li>
<li>テストとベンチマーク</li>
<li>画像と音声</li>
<li>ゲーム開発</li>
<li>データ構造とアルゴリズム</li>
</ul>
<p>Pursuitにはありとあらゆるライブラリが揃っています。もし求めているライブラリにぴったりくるものがないのであれば、外部関数インターフェイスを使って、NPMにあるJavaScriptのライブラリをラップして使うことが簡単にできます!</p>
<h2>より強力な保証</h2>
<p>JavaScriptでは、コードの振る舞いに保証はほとんどありません。たとえば、以下の様なことを確認するのは難しいです。</p>
<ul>
<li>データは正しい形式なのか</li>
<li>値は<code>null</code>でないのか</li>
<li>正しい箇所で例外を扱っているか</li>
<li>製品としてデプロイするまえに、デバッギングコードを取り除いているか</li>
<li>複雑なパターンマッチングで、すべての可能性を網羅しているか</li>
<li>可変のデータ構造への参照が漏れていないか</li>
<li>SQLインジェクション攻撃を回避する適切な手順が取られているか</li>
<li>アプリケーションがうっかり<a href="https://hackage.haskell.org/package/acme-missiles-0.3/docs/Acme-Missiles.html">ミサイルを発射</a>を発射してしまわないか</li>
</ul>
<p>PureScriptの型システムは、これらすべてのバグはもとより、さまざまなバグを確実に防ぐ手段を与えてくれます。</p>
<h2>優れたレコード</h2>
<p>拡張可能レコード<a href="#footnote-record" id="anchor-record">※</a>はJavaScriptにとてもよく適していますが、もしJavaScriptのよくあるイディオムが使えないとしたら、それは使いにくくなってしまうでしょう。</p>
<p>PureScriptでは、レコードをマップしたり、トラバースしたり、レコードどうしをマージしたり、ZIPしたり、というようなよくあるパターン<a href="#footnote-map" id="anchor-map">※</a>を、まったく型安全に<a href="https://github.com/purescript/purescript-typelevel-prelude/">表現することができます</a>。</p>
<p><a href="https://pursuit.purescript.org/packages/purescript-profunctor-lenses/3.2.0/docs/Data.Lens.Record#v:prop">レコードのラベルについて抽象化</a>することもできます。型システムを使ってレコードのプロパティのLensを自動的に導出することができるので、同じようなLensを何度も書くことはありません。</p>
<h2>優れたツール</h2>
<p>PureScriptは<a href="https://github.com/paf31/24-days-of-purescript-2016/blob/master/15.markdown">即時再ビルド</a>(instant rebuilds)を提供しており、エディタ上でコンパイルエラーを即座に確認することができます<a href="#footnote-tools" id="anchor-tools">※</a>。また、エディタのプラグインで、警告を自動的に修正したり、インポート一覧を自動的に最小化したりすることもできます。</p>
<p>『型』を作業にも役立てましょう！<a href="https://github.com/paf31/24-days-of-purescript-2016/blob/master/23.markdown">型に基づいた検索</a> (Type-directed search)は、型の情報を利用して、コードの隙間に適合するプログラムを自動的に発見してくれます。</p>
<p>コンパイラにコードを書かせましょう。PureScriptは　たくさんの <a href="https://github.com/paf31/24-days-of-purescript-2016/blob/master/3.markdown">よくある</a> <a href="https://github.com/paf31/24-days-of-purescript-2016/blob/master/4.markdown">型</a> <a href="https://github.com/paf31/24-days-of-purescript-2016/blob/master/5.markdown">クラス</a>について、インスタンスを自動で導出することができます。導出がもし提供されていなければ、実装を埋めるのに<a href="https://github.com/paf31/24-days-of-purescript-2016/blob/master/11.markdown">generic deriving</a>を使える場面がよくあります。</p>
<h2>優れた手法</h2>
<p>Haskellによって開拓された様々なパラダイムを、PureScriptでも数多く提供しています。たとえば、</p>
<ul>
<li><a href="https://github.com/paf31/24-days-of-purescript-2016/blob/master/11.markdown">データ型に基づくジェネリックプログラミング</a></li>
<li><a href="https://github.com/paf31/24-days-of-purescript-2016/blob/master/10.markdown">関数的従属性</a>(functional dependencies)による型レベルプログラミング</li>
<li><a href="https://github.com/purescript/purescript-quickcheck">性質に基づいたテスト</a>(Property-based testing)</li>
<li>表示的意味論による設計(Denotational design)</li>
</ul>
<p>PureScriptは最新の手法を実装した優れた言語でもあるのです。</p>
<p>PureScriptはプログラミング言語の新しい機能についてのアイデアを試すための絶好の遊び場にもなっています。もしJavaScriptがターゲットではないアイデアを試したいと思うなら、コンパイラの<a href="https://github.com/purescript/documentation/blob/master/ecosystem/Alternate-backends.md">異なるバックエンド</a>をご自分でビルドすることもできます。</p>
<h2>素晴らしいコミュニティ</h2>
<p>Slackや<a href="http://reddit.com/r/purescript">Reddit</a>、IRCなどで、静的型付けされた純粋関数型プログラミング言語をウェブブラウザの世界へ導入することに期待している仲間たちを探してみましょう。</p>
<h1>よくある不満点</h1>
<h2>『コードの共有が難しい』<a href="#footnote-share" id="anchor-share">※</a></h2>
<p>これは以前は確かにそうだったのですが、現在では<a href="https://hackage.haskell.org/package/purescript-bridge"><code>purescript-bridge</code></a>や<a href="https://github.com/eskimor/servant-purescript"><code>servant-purescript</code></a>といった優れた手段が存在しています。</p>
<p>データ型についてのジェネリックプログラミングは、JSON直列化のような最も重要なものを含む、データ型の共有について書く必要があるコードのほとんどについて、自動導出をとても容易にしてくれます。</p>
<h2>『正格評価がデフォルトなのが良くない』</h2>
<p>これは興味深い不満点です。私は毎日Haskellを使っており、遅延性を大規模に利用しています。Haskellのような言語の遅延評価の落とし穴について書かれた、素晴らしい投稿もインターネットにはいろいろあります(<a href="http://augustss.blogspot.com/2011/05/more-points-for-lazy-evaluation-in.html">これとか</a>)。</p>
<p>私が思うに、正格な言語であるかのようにHaskellを使うことが間違いであるように(『スペースリーク』はこういう間違いの典型です)、遅延評価の言語であるかのようにPureScriptを使うのが間違いなのです。</p>
<p>HaskellコードをそのままPureScriptに持ってきて、それがそのまま動くというようには、考えてはいけないということです。もしかしたら動くかも知れませんが、遅いかも知れませんし、ループにはまり込んでクラッシュしたり、そもそもコンパイルできないかも知れません。</p>
<p>しかし、正格な言語における純粋な関数型プログラミングを支援する優れたツールがあります。まったく新しいものもありますし、Scalaのような他の正格な関数型言語で開拓されたテクニックからアイデアを得たものもあります。</p>
<p>究極的には、遅延評価がデフォルトであることの利点のすべてが欲しいなら、GHSJSを使ったほうがいいでしょう。でも、ほとんどの場合は、正格評価がデフォルトの言語で、必要に応じて遅延評価を導入したほうが、ずっと実用的な選択肢になることに留意してください。</p>
<h2>『技術者を雇うのが難しい』</h2>
<p>Haskellのコミュニティは、これが間違いであることを裏付けています。リモートでPureScript開発者を雇用すれば(そしてもし必要なら研修を気前よく実施すれば)、条件に見合う就職希望者が不足することはないでしょう。</p>
<p>別の言い方をすれば、外部関数インターフェイスを学び、既存のJavaScriptコードへと統合しすることで、PureScriptを段階的に導入することもできます。そのため、多少の関数型プログラミングの経験があるJavaScript開発者を雇い、既存のコードをだんだんとPureScriptへと移行させることでPureScriptの利点を享受することができます。</p>
<h2>『学習が難しい』</h2>
<p>PureScriptを学ぶのは決して簡単なことではありませんが、十分に可能なことです。少し時間はかかります。</p>
<p>他の人へ教えるというのもまた別の難しさがあり、それもまた多くの時間がかかるでしょう。</p>
<p>もしHaskellや純粋関数型プログラミングに詳しくないのであれば、まずは<a href="http://haskellbook.com/">Haskellの本</a>を通じて学ぶのをお勧めします。それから、<a href="https://leanpub.com/purescript">PureScriptの本</a>へと進み、PureScriptのコードの振る舞いについての考え方を理解するために、Puresuitにある中核ライブラリのドキュメントを読んだりするといいでしょう。</p>
<h2>『圏論はもうたくさんだ』</h2>
<p>PureScriptの習熟にあたって圏論についての知識は必要ありませんが、中核ライブラリの更なる深淵へと辿り着くときの助けにはなるのは間違いありません。圏論を修得するというのは、長期的な投資です。</p>
<p>もし理論的基礎を学ぶことに興味あるのであれば、計算機科学者向けか何かの標準的な圏論の教科書の、最初の章を読んでみることをお勧めします。</p>
<h2>『サポートが不足している』</h2>
<p>まあ要するに、PureScriptコンパイラの開発にお金を出してくれるひとがいないということです。これはいつか変わることがあるかもしれませんが、今のところは長期間のサポートを期待するのは無理です。PureScriptは他のオープンソースライブラリと同じように扱うのをお勧めします。</p>
<p>まあそうは言っても、でももしあなたがどうしてももっと良いサポートを必要としているのであれば、小銭と交換でってことになるかも知れませんね。</p>
<h2>『ドキュメントが足りない』</h2>
<p>高品質なドキュメントを提供するために最善を尽くしていますが、複雑な考え方をわかりやすく説明するのは難しい問題ではあります。</p>
<p><a href="https://github.com/purescript/documentation">プルリクエストは歓迎です</a>! もしドキュメントを改善する方法について考えがあるのなら、ぜひ教えて下さい。でも、もし<code>Functor</code>を<code>Mappable</code>に改名するつもりはないと私たちが言ったとしても、どうか落ち着いてください。</p>
<h2>『PureScriptは変更が早過ぎる』</h2>
<p>PureScriptは1.0に到達するまでは破壊的変更が続くでしょうが、このマイルストーンはかなり近づいています。いろいろと安定してきていますし、0.12.0から1.0までは破壊的変更はあまり多くないと思います。</p>
<h2>『Bowerは好きじゃない』</h2>
<p>Bowerを使っているのには幾つかの理由があり、それについてはハリーさんが<a href="http://harry.garrood.me/blog/purescript-why-bower/">詳細に書いてくれています</a>。BowerがJavaScriptに適するかどうかはともかく、それでもPureScriptにはぴったりと適しているのです。</p>
<p>でも、Bowerを使わなければならないというわけではありません。<a href="https://github.com/purescript/psc-package/"><code>psc-package</code></a>と<a href="https://github.com/chrisdone/purify">Purify</a>という代替のパッケージマネージャがすでに存在しています。</p>
<p>PureScriptで<a href="https://nixos.org/nix/">Nix</a>を使う人や、Gitを直接使っている人もいます。PureScriptは特定のパッケージマネージャへ依存しているわけではありません。</p>
<h2>『Nodeを使いたくない』</h2>
<p>前項をご覧ください。特に<code>psc-package</code>とPurifyはNodeには依存していません。</p>
<p>REPLについては、Nodeを使う代わりに、<a href="https://github.com/paf31/24-days-of-purescript-2016/blob/master/8.markdown">ブラウザで<code>--port</code>オプションを使って評価することもできます</a>。</p>
<br>
<br>
<hr />
<p class="footnote"><a name="footnote-record" href="#anchor-record">^</a>訳注・ここでいう『レコード』とは、JavaScriptのプレーンなオブジェクトに相当するものです。Haskellにはない機能ですが、PureScriptではJavaScriptとの親和性を高めるために採用されており、JavaScriptと同じように`foo.bar`というような構文でレコードのプロパティにアクセスできます。</p>
<p class="footnote"><a name="footnote-map" href="#anchor-map">^</a>訳注・要するに、`Object.keys`でオブジェクトのプロパティ名を列挙して反復するとか、そういうメタ的な操作がPureScriptでも型安全にできるということです。最近になって型レベルプログラミングの機能が揃うまでは、こうした操作は難しい部分がありました。</p>
<p class="footnote"><a name="footnote-tools" href="#anchor-tools">^</a>訳注・編集があった特定のソースファイルのみを再ビルドすることで、コンパイルエラーを瞬時に確認することができるということです</p>
<p class="footnote"><a name="footnote-share" href="#anchor-share">^</a>訳注・これは何を言っているかというと、PureScriptはHaskellと言語仕様に互換性がないのでコードが共通化できず、データ交換が面倒だった、ということです。現在では、`purescript-bridge`のようなツールで、HaskellのコードからPureScriptのコードを生成できるようです。</p></div></article></div><footer><div class="sns"><a target="_blank" href="https://twitter.com/intent/tweet?text=undefined%20https%3A%2F%2Faratama.github.io%2Fblog%2F96a4a202a9a3471a9b4c"><img src="/res/twitter.png" alt="twitter button"></a><a target="brank" href="http://www.facebook.com/sharer.php?u=https%3A%2F%2Faratama.github.io%2Fblog%2F96a4a202a9a3471a9b4c&amp;t=undefined"><img src="/res/facebook.png" alt="facebook button"></a><a target="brank" href="https://plus.google.com/share?url=https%3A%2F%2Faratama.github.io%2Fblog%2F96a4a202a9a3471a9b4c"><img src="/res/google.png" alt="google plus button"></a><a target="brank" href="http://b.hatena.ne.jp/entry/https%3A%2F%2Faratama.github.io%2Fblog%2F96a4a202a9a3471a9b4c"><img src="/res/hatena.png" alt="hatena bookmark button"></a><a target="brank" href="http://getpocket.com/edit?url=https%3A%2F%2Faratama.github.io%2Fblog%2F96a4a202a9a3471a9b4c&amp;title=undefined"><img src="/res/pocket.png" alt="pocket button"></a></div><div class="block-centered footer-inner"><p class="copy">&amp;nbsp;</p><p class="author">このブログを書いてる人: 竹内稲穂</p></div><script>
                    const poem = [
                        "なんにもない毎日が、なによりの宝物。",
                        "今日という日を、何度でも繰り返したい。",
                        "世界を追いかけなくても、世界は私のまわりにある。", 
                        "速すぎる雑踏。鼻先をくすぐる春風。", 
                        "明日撮る写真を飾る場所を、アルバムに空けておこう。", 
                        "落ち葉が地面に、触れる音がした。", 
                        "明日は、明日の楽しさが待っている。", 
                        "風が泣いている。この想いを紡ぐ言葉を持たないから。", 
                        "もうここには何もない。だから、次の場所に旅立とう。", 
                        "もう此処にはこないだろう。そう言って私は過去に背を向けた。", 
                        "散りゆくからこそ、美しい。私は桜の花びらをかかとで踏みしめた。", 
                        "思い出はいつだって輝いてる。",
                        "正直ばかりじゃつまらない。たまには楽しい嘘をつこう。", 
                        "ゆっくり歩けば歩くほど、時間がゆっくり過ぎてゆく。",
                        "夜明けを、探しにいこう。", 
                        "空はこんなに青かったんだ。", 
                        "地球は青かった。それはこの空を見上げたことのある全員が知っている。", 
                        "休み時間は、長すぎるということはない。", 
                        "缶コーヒーを飲むときだけは、それ以外のすべてを忘れることにしてる。", 
                        "ちょっと小さいのは確かですが、それは確かにここにあります。", 
                        "ちょっと小さいのは確かですが、広すぎる家というのも寂しいでしょう？", 
                        "ひつじが一匹、ひつじが二匹。五十匹までは、数えたことがある。"
                    ];
                    document.querySelector(".copy").textContent = poem[Math.floor(poem.length * Math.random())];
                </script></footer></body></html>