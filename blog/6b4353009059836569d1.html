<title>モナドのまほう　第15話『babylon.jsの水面マテリアルの流れは絶えずして』 - ちょっと小さいのはたしかですが。</title>

<header>
    <div class="block-centered">
        <div class="site-title"><a href="index.html">ちょっと小さいのはたしかですが。</a></div>
        <div class="sub-title">わたしのブログです。面白いかどうかは、わかりませんが。</div>
    </div>
</header>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

<link rel="stylesheet" href="/res/highlight/styles/default.css">
<script src="/res/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>



<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$']]}
});
</script>

<link rel="stylesheet" href="../reset.css">
<link rel="stylesheet" href="../style.css">
<link rel="stylesheet" href="../article.css">


    <div class="content">

        <article id="rendered">
            <div class="date">2016年12月28日</div>
            <h1 class="article-title">
                <!-- <i class="fa fa-coffee" aria-hidden="true"></i> -->
                <a href="6b4353009059836569d1.html">モナドのまほう　第15話『babylon.jsの水面マテリアルの流れは絶えずして』<a>
            </h1>        
            <p class="tags"><a href="JavaScript.html"><span class="tag"><i class="fa fa-tag" aria-hidden="true"></i>JavaScript</span></a>
<a href="Babylon.js.html"><span class="tag"><i class="fa fa-tag" aria-hidden="true"></i>Babylon.js</span></a>
<a href="ゲーム開発.html"><span class="tag"><i class="fa fa-tag" aria-hidden="true"></i>ゲーム開発</span></a>
<a href="Firebase.html"><span class="tag"><i class="fa fa-tag" aria-hidden="true"></i>Firebase</span></a>
<a href="RPGアツマール.html"><span class="tag"><i class="fa fa-tag" aria-hidden="true"></i>RPGアツマール</span></a></p>
            <hr>
            <!-- {
  "id": "6b4353009059836569d1",
  "created_at": "2016-12-28T12:14:30+09:00",
  "tags": [
    {
      "name": "JavaScript",
      "versions": []
    },
    {
      "name": "Babylon.js",
      "versions": []
    },
    {
      "name": "ゲーム開発",
      "versions": []
    },
    {
      "name": "Firebase",
      "versions": []
    },
    {
      "name": "RPGアツマール",
      "versions": []
    }
  ],
  "title": "モナドのまほう　第15話『babylon.jsの水面マテリアルの流れは絶えずして』"
} -->
<p><a href="5321d8cebce7b87851f6.html">第一話</a> / <a href="910354220d14d597b876.html">前回</a> / <a href="https://aratama.github.io/cubbit/.html">デモ</a> / <a href="http://magicofstella.com/.html">ステま</a></p>
<p>ゲームを作る日記です。ステラのまほうのアニメの続きを観たすぎたので、この記事のタイトルを変えました。</p>
<h1><a name="-" class="anchor" href="#-"><span class="header-link"></span></a>水面マテリアルを移植しました</h1><p>バグで動かなかったbabylonjsの水面マテリアルですが、悪さをしていたデコレータの部分をコメントアウトし、バグを回避する形にして無理やり使えるようにしました。ソフトウェア開発なんてどうせ最後はこういう力技です。</p>
<p><a href="/img/daacae26-e650-1dc8-859c-38107335864b.png"><img src="/img/daacae26-e650-1dc8-859c-38107335864b.png"></img></a></p>
<p>おーキレイキレイ。風で水面にさざ波が立っていて、デモを動かすとわかると思いますがちゃんとアニメーションもしています。本作のややディフォルメされたグラフィックデザインの中にあってはちょっとわざとらしい感もありますが、以前のゼリーみたいな水面とは段違いです。そしてかなり重いです。水面のレンダリングリストに入っているのがスカイボックスだけならまあなんとかというところなんですが、周囲の地形まで水面に反映させようとすると重くてゲームになりません。すごいグラボのマシンを持っているひとならいいのかもしれませんが……。あと何か微妙に反射が変な部分がありますし、設定をオフにしても再読込するまで重いままになるバグがあります。</p>
<h1><a name="-" class="anchor" href="#-"><span class="header-link"></span></a>多言語化しました</h1><p>多言語化しました。コンフィグ画面で日本語と英語を切り替えることができます。英語だってだけで敬遠する人も多いでしょうし、私も英語でキャラクターのセリフを書くのはさすがにキツいです。シナリオはたぶん一旦日本語で書いてから英語に翻訳する形になりそうです。</p>
<p><a href="/img/bc490cbd-f286-eaf5-3526-f855fa0cee55.png"><img src="/img/bc490cbd-f286-eaf5-3526-f855fa0cee55.png"></img></a></p>
<p>テキストデータはハードコーディングされています。編集には再コンパイルが必要ですが、まあ書くのはどうせぜんぶ私なので問題はないでしょう。最初にアクセスしたときに<code>navigator.language</code>プロパティを読み取って言語を判定し、デフォルト値として使用しています。</p>
<h1><a name="-" class="anchor" href="#-"><span class="header-link"></span></a>アツマールのメモ</h1><p>ニコニコのRPGアツマールのAPIドキュメントが公開されたようです。自分で調べる必要なかったですね。</p>
<ul>
<li><a href="http://ch.nicovideo.jp/indies-game/blomaga/ar1163608.html">ニコニコ自作ゲームフェス
RPGアツマール ゲームAPI仕様書</a></li>
</ul>
<p><a href="http://html5.nicogame.jp/core/player/js/rpgatsumaru.js.html">rpgatsumaru.js</a>ってのがAPIを提供しているみたいですが、このあたりを眺めただけじゃ使い方はよくわからないです。そのうちコメント対応の実験してみます。</p>
<ul>
<li><a href="http://blog.nicovideo.jp/atsumaru/2016/12/post-1.html.html">【ゲーム企画支援】全力ゲーミング!!!参加募集開始</a></li>
</ul>
<p>ふむふむ。企画書書いて採用されれば３０万円くれて、他にもいろいろ特典があるみたいです。私はプロモーション活動はすごく苦手なので、プロモーション打ってくれるなら嬉しいですね。</p>
<blockquote>
<p>・制作方法はRPGアツマールに投稿できるHTML5ゲーム形式であれば自由です。ツクールMVである必要はありません。</p>
</blockquote>
<p>アツマールはツクールMV製以外は考慮に入っていないのかと思っていましたが、HTMLゲームなら別に構わないみたいですね。APIも公開されたことだし。</p>
<blockquote>
<p>また、完成したゲームについては、本サイト<strong>だけ</strong>に投稿頂くことを予め承諾します。</p>
</blockquote>
<p>OH……アツマール『だけ』っていう条件はなかなか厳しいですね。アツマール専用に企画を立てろってことでしょう。今作ってるゲームはオンラインマルチプレイ前提で、アツマールからではFirebaseに接続不可なので、技術的制限もあって私はそもそもまったく対象外のようです（まあシングルプレイモードはあるんですが）。別のゲームをつくる余裕はないので、誰かフリゲを作る予定のある人は応募してみてはどうでしょうか。</p>
<h1><a name="todo-" class="anchor" href="#todo-"><span class="header-link"></span></a>TODOリスト</h1><p>マルチプレイヤーモードよりもシングルプレイヤーモードのほうが作業量が多い！　ので、ひと通り形になったら、ひとまずマルチプレイヤーモードの完成を目指すのが良さそうです。</p>
<h4><a name="-" class="anchor" href="#-"><span class="header-link"></span></a>モード共通</h4><ul>
<li>操作ガイド（簡単だが面倒くさい）</li>
<li>全画面対応（簡単）</li>
<li>ゲームパッド対応（簡単）</li>
<li>一人称視点での地形編集のバグ修正及び機能拡充（簡単）</li>
<li>ブロックの種類の拡充(簡単だが作業はエンドレス）</li>
<li>BGM製作（難しい。やりたいが作曲ノウハウがゼロ。素材で代替可能なので優先順位低）</li>
<li><del>リソース取得の遅延（難しいし面倒くさい）現状の最初に一括してダウンロードするのは、安心ではありますがとにかく遅い！でも最初にロードしてしまったほうがプレイ時のストレスが小さいんですよね。シーンの切替時に長いロードが挟まるのは嬉しくない</del> いろいろ考えましたが、どんなに時間がかかろうが最初にすべてのリソースを読んでしまったほうがプレイが快適だという結論に。コンパイルが遅延されているせいでキャラクターモデルが一瞬不自然に表示されてしまう問題を、むしろどうするか……。</li>
</ul>
<h4><a name="-" class="anchor" href="#-"><span class="header-link"></span></a>マルチプレイヤーモード</h4><ul>
<li>マルチプレイ用キャラクターモデル作成（難しくはないが作業量が多い）</li>
</ul>
<h4><a name="-" class="anchor" href="#-"><span class="header-link"></span></a>シングルプレイヤーモード</h4><ul>
<li>RPGアツマールのコメント機能対応実験（簡単）</li>
<li>表情アニメーション（難しい）（具体的には<a href="http://www.jp.square-enix.com/info/images/image_technical_seminar2014_06/pdf/SQEX_DevCon_sugimoto.pdf.html">スクストのコレ</a>を実装したいです）</li>
<li>フルモーションシーン（プログラミング側は簡単だがBlender側が大変)</li>
<li>シナリオ執筆（わりと難しい。フルモーションシーンが流せるようになってから？）</li>
</ul>
<p>前に買ったゲームパッド、どこ行ったんだろ……。</p>
<h1><a name="-" class="anchor" href="#-"><span class="header-link"></span></a>次のお話</h1><ul>
<li><a href="02cea526f5487d579cec.html">第16話</a></li>
</ul>

            <hr>
            <div class="snsbuttons">

                <!-- Hatena -->
                <div>
                    <a href="http://b.hatena.ne.jp/entry/" class="hatena-bookmark-button" data-hatena-bookmark-layout="basic-label-counter" data-hatena-bookmark-lang="ja" title="このエントリーをはてなブックマークに追加"><img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" /></a><script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
                </div>

                <!-- line -->
                <div>
                    <div class="line-it-button" style="display: none;" data-type="share-a" data-lang="ja" ></div>
                    <script src="//scdn.line-apps.com/n/line_it/thirdparty/loader.min.js" async="async" defer="defer" ></script>
                </div>

                <!--facebook -->
                <div>
                    <div id="fb-root"></div>
                    <script>(function(d, s, id) {
                    var js, fjs = d.getElementsByTagName(s)[0];
                    if (d.getElementById(id)) return;
                    js = d.createElement(s); js.id = id;
                    js.src = "//connect.facebook.net/ja_JP/sdk.js#xfbml=1&version=v2.8";
                    fjs.parentNode.insertBefore(js, fjs);
                    }(document, 'script', 'facebook-jssdk'));</script>
                    <div class="fb-like" data-href="https://aratama.github.io/blog/6b4353009059836569d1.md" data-layout="button_count" data-action="like" data-size="small" data-show-faces="true" data-share="false"></div>
                </div>

                <!-- google+ -->
                <div>
                    <script src="https://apis.google.com/js/platform.js" async defer>
                    {lang: 'ja'}
                    </script>
                    <div class="g-plusone" data-size="medium"></div>
                </div>

            </div>

        </article>
    </div>

<footer>
    <div class="block-centered footer-inner">
        <p class="copy">&nbsp;</p>
        <p class="author">このブログを書いてる人:&nbsp;&nbsp; <a target="_blank" href="https://twitter.com/cubbit2">兎沢</a><p>
    </div>

    <script>
        const poem = [
            "なんにもない毎日が、なによりの宝物。",
            "今日という日を、何度でも繰り返したい。",
            "世界を追いかけなくても、世界は私のまわりにある。", 
            "速すぎる雑踏。鼻先をくすぐる春風。", 
            "明日の写真を飾る場所を、アルバムに空けておこう。", 
            "落ち葉が地面に、触れる音がした。", 
            "明日は、明日の楽しさが待っている。", 
            "風が泣いている。この想いを紡ぐ言葉を持たないから。", 
            "もうここには何もない。はじまりの時が来た。"
        ];
    document.querySelector(".copy").textContent = poem[Math.floor(poem.length * Math.random())];
    </script>
</footer>

