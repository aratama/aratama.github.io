<title>モナドのまほう　第６話『makehumanとBlenderで涼風青葉ちゃんごっこの巻』 - ちょっと小さいのはたしかですが。</title><!DOCTYPE html>
<meta charset="UTF-8">
<link type="text/css" rel="stylesheet" href="style.css">

<header>
    <div class="block-centered">
        <div class="site-title"><a href="/index.html">ちょっと小さいのはたしかですが。</a></div>
        <div class="sub-title">わたしのブログです。面白いかどうかは、わかりませんが。</div>
    </div>
</header>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

<link rel="stylesheet" href="/res/highlight/styles/default.css">
<script src="/res/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>



<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$']]}
});
</script>

<link rel="stylesheet" href="../reset.css">
<link rel="stylesheet" href="../style.css">
<link rel="stylesheet" href="../article.css">


    <div class="content">

        <article id="rendered">
            <div class="date">2016年11月24日</div>
            <h1 class="article-title">
                <!-- <i class="fa fa-coffee" aria-hidden="true"></i> -->
                <a href="247c6c0034b6383c5436.html">モナドのまほう　第６話『makehumanとBlenderで涼風青葉ちゃんごっこの巻』<a>
            </h1>        
            <p class="tags"><a href="Blender.html"><span class="tag"><i class="fa fa-tag" aria-hidden="true"></i>Blender</span></a>
<a href="Babylon.js.html"><span class="tag"><i class="fa fa-tag" aria-hidden="true"></i>Babylon.js</span></a>
<a href="makehuman.html"><span class="tag"><i class="fa fa-tag" aria-hidden="true"></i>makehuman</span></a></p>
            <hr>
            <!-- {
  "id": "247c6c0034b6383c5436",
  "created_at": "2016-11-24T18:50:54+09:00",
  "tags": [
    {
      "name": "Blender",
      "versions": []
    },
    {
      "name": "Babylon.js",
      "versions": []
    },
    {
      "name": "makehuman",
      "versions": []
    }
  ],
  "title": "モナドのまほう　第６話『makehumanとBlenderで涼風青葉ちゃんごっこの巻』"
} -->
<ul>
<li><a href="/blog/5321d8cebce7b87851f6.html">第一話　画像が表示できました</a>　←初回</li>
<li><a href="/blog/7cba851de4d84a535bbb.html">第五話　Babylonjsでｹﾞｰﾄｵﾌﾞﾊﾞﾋﾞﾛﾝ</a>　←前回</li>
</ul>
<p>テキトーに楽しくゲームを作る日記の続きです。今回はコードが1ビットも出てきませんが許してください。</p>
<h1><a name="-" class="anchor" href="#-"><span class="header-link"></span></a>キャラクターモデリングがんばるぞい</h1><p>それじゃあ今から<a href="/blog/http://newgame-anime.com/character/.html">涼風青葉ちゃん</a>ごっこします！　自分でイチからモデリングするのは大変なので、<a href="/blog/http://www.makehuman.org/.html">makehuman</a>という3D人物モデルを作れるオープンソースソフトウェアを使います。「負け不満」なんていうネガティブな名前なのに、性別、年齢、体格なんかをスライダで設定すると自動でそれっぽい人体モデルを作成してくれる凄いやつです。ゲームにあるキャラクタークリエイト機能みたいなものです。</p>
<p><a href="/img/9da07b65-4e21-64a8-8577-1dbad89a05f0.png"><img src="/img/9da07b65-4e21-64a8-8577-1dbad89a05f0.png"></img></a></p>
<p>性別や年齢、身長や筋肉量、人種などのいろんなパラメータがあるので、これを適当にいじります。今回はゲーム用ということで、アニメ的なディフォルメのキャラクターを作るつもりなので年齢を低めにして頭身を下げます。開放感が溢れすぎていて公然わいせつ罪的な意味で危険が危ない感じがしたので、適当に服も着せました。</p>
<p><a href="/img/a6bde869-acd3-b84d-eed5-68303c4e484f.png"><img src="/img/a6bde869-acd3-b84d-eed5-68303c4e484f.png"></img></a></p>
<p>あとはこれを<code>.dae</code>(Collada)形式でエクスポート。それをオープンソースの3DCGオーサリングツール<a href="/blog/https://www.blender.org/.html">Blender</a>にインポートすれば、この通りです。</p>
<p><a href="/img/660d897a-9b36-857d-1846-f1eb980252f0.png"><img src="/img/660d897a-9b36-857d-1846-f1eb980252f0.png"></img></a></p>
<p>眼球のテクスチャがうまくキマっていないのか白目を剥いていますが、どうせ顔なんかは大幅に作り変えるので問題ありません(っていうかこの画像はQiitaでの説明用で、髪の毛とか邪魔なので実際には全裸でインポートしました)。</p>
<h1><a name="-" class="anchor" href="#-"><span class="header-link"></span></a>下絵を描きましょう</h1><p>Blenderにインポートしたら、まずはモデルの右半身の頂点をバッサリ削除し、代わりにMirrorモディファイアで左右対称にミラーリングします。それからDecimateモディファイアで頂点数を削減したり、それからあとは足を伸ばしたり腕を細くしたりとアニメ体型にひたすら魔改造します。顔はテクスチャで表現することにして、眼球や口の中の頂点はばっさり削って塞ぎました。リアルな口パクとかしたいなら目や口もちゃんと残したほうがいいんですが、アニメ的な表現でそれをやると不気味になりがちですし、陰影のつき方が不自然になりがちなので避けました。雰囲気の確認のためにマテリアルやテクスチャも簡単に割り当てます。それでこんな感じになります。</p>
<p><a href="/img/e688f1c1-b15b-d120-8dc2-570c52faf4b5.png"><img src="/img/e688f1c1-b15b-d120-8dc2-570c52faf4b5.png"></img></a></p>
<p><a href="/img/d3566366-341d-3728-7e01-c9d2c5c88afd.png"><img src="/img/d3566366-341d-3728-7e01-c9d2c5c88afd.png"></img></a></p>
<p>うん。ぜんぜん可愛くない。ゲームではキャラクターの見た目は重要なので、なんとかしなくては。どこか全体のバランスがおかしい感じがしますし、髪型がヘルメット状態なのもあってどこかのっぺりとした表情ですね。髪型も何の目安もなく頂点をいじってもうまく形にならなくて難しいです。うまい人はいきなりモデリングでうまくいくんでしょうが、筆者にそこまでの技術はないので、いったん２次元のデザイン画を起こして、それをトレースすることにします。普通はデザインを決めてからモデリング始めるのでしょうが、このシリーズのコンセプトはとにかく「行き当たりばったり」なので手戻りが多いです。</p>
<p>二次元のお絵かきはこのあいだまで<a href="/blog/http://www.clipstudio.net/.html">CLIP STUDIO PAINT</a>を使っていたんですが、このあいだ試用期限が切れてしまったので、その代わりに<a href="/blog/https://medibangpaint.com/.html">MediBang Paint</a>を試しています。なんか左右対称ツールがツールを切り替えるたびに軸を設定しなおさなくてはならなくてちょっと使いづらい……。ClipStudio買おうかな……。</p>
<p><a href="/img/8d6d537c-e93e-de58-62f2-b883b526dad8.png"><img src="/img/8d6d537c-e93e-de58-62f2-b883b526dad8.png"></img></a></p>
<p>なんか物足りなく感じたので、あざといデカリボンとか生やしたら、なんか島風っぽくなってしまいました。島風ではないです。天江衣とかでもないです。一応このキャラクターデザインにも意味はあるのですが、あまりに行き当たりばったりに作っているので、この設定が実際に活かされるのかは謎です。それでBlenderに下絵として読み込み、大きさと位置をなんかいい感じに合わせます。</p>
<p><a href="/img/a9e58a83-656c-6dcf-e8a8-872ed685e0ab.png"><img src="/img/a9e58a83-656c-6dcf-e8a8-872ed685e0ab.png"></img></a></p>
<p><a href="/img/c67749ea-b34d-de1e-a6e6-053c812fc3ae.png"><img src="/img/c67749ea-b34d-de1e-a6e6-053c812fc3ae.png"></img></a></p>
<p>イラストと合わせるとわかるんですが、makehumanからインポートしてなんとなくいじった顔って全体的に顔のパーツが上に寄っていますね。というかアニメ顔が基本的にパーツが全部下寄りなので、makehumanのリアルな頭身をアニメ的にするには、かなり全体を下に下げないといけないみたいです。それでひたすらいじること数時間。髪の毛ももう少しちゃんと生やして、テクスチャもなんかそれっぽい感じで仮置きして、こんな感じです。</p>
<p><a href="/img/00b3f551-4199-66d0-9036-8cc9fea47660.png"><img src="/img/00b3f551-4199-66d0-9036-8cc9fea47660.png"></img></a></p>
<p>なんか思っていたよりも少し頭身が高い感じがしますが、まあこんなものかもしれません。あんまり頭身が高いとカメラが引いた時に見づらいですが、ディフォルメし過ぎると今度はカメラが寄ったときに見栄えがイマイチになる気がします。キャラクターデザインもなんか物足りない気がするので、何か小物が欲しいですね。さらに、ゲーム内で実際に表示すると、Blenderで編集しているときとはまた違った感じで見えるので、今後も調整が延々と続きます。</p>
<p>それで、出来たキャラクターモデルをゲーム内に表示してみるとこんな感じになります。BabylonjsにBlenderからのエクスポートとインポートの機能があるので、ボーンアニメーションも含めてコーディング自体は簡単です。</p>
<p><a href="/img/e75b3f31-4d13-177d-01e2-784aaea9c970.png"><img src="/img/e75b3f31-4d13-177d-01e2-784aaea9c970.png"></img></a></p>
<p>シーン全体に平行光源がひとつだけなので、顔に影が落ちてすごく見苦しいですね。初代プレイステーションのグラフィックみたいなチープ感があります。発光か環境光を設定して影の部分を明るくするか、キャラクター専用の光源が必要かもしれません。シェーディングもセルシェーディングにしたいですね。それかいっそのことシェーディングを切ってしまったほうがまだ見栄えがいいかもしれません。この辺りもノウハウが全然ないので研究が必要です。</p>
<h1><a name="-a-href-blog-https-www-google-co-jp-search-q-e3-81-b2-e3-81-b5-e3-81-bf-e3-82-93-amp-source-lnms-amp-tbm-isch-amp-sa-x-html-a-" class="anchor" href="#-a-href-blog-https-www-google-co-jp-search-q-e3-81-b2-e3-81-b5-e3-81-bf-e3-82-93-amp-source-lnms-amp-tbm-isch-amp-sa-x-html-a-"><span class="header-link"></span></a><a href="/blog/https://www.google.co.jp/search?q=%E3%81%B2%E3%81%B5%E3%81%BF%E3%82%93&amp;source=lnms&amp;tbm=isch&amp;sa=X.html">「ひふみん」で検索する</a>とひふみんの画像と加藤一二三九段の画像が交互に表示される件</h1><p>キャラクターのモデリングは大変なので、人間型キャラクターはこのプレイヤーキャラクターひとりだけにする予定です。でも、マルチプレイヤーオンラインゲームなら他のプレイヤーも表示しなくてはならないので、そのあたりどうするか考えなくてはいけません。なんかシルエット的なものを表示するだけでもいいと思います。</p>
<p>プログラムも書かないといけないのに、キャラクターモデリングまで始めるともう時間と体力がいくらあっても足りないです。筆者はこれで更にBGM制作までやろうとしてますからね……。先は長いです。このシリーズ始めたときにはゾンビサバイバルアクション作るとか言ってたのに(GAIJINはみんなゾンビ好きなので)、いつの間にかマインクラフトになっていて、メルヘンで萌えっぽい感じになってきたよ！　いったいこのゲームはどこに向かっているんだ！</p>
<p>そういえばQiitaの仕様変わりましたね。ちなみに私はひふみんが一番好きです。ひふみんが好きな人はこの記事に「いいね」をしといてください。</p>
<h1><a name="-" class="anchor" href="#-"><span class="header-link"></span></a>次のお話</h1><ul>
<li><a href="/blog/2d186fd463afa50075b5.html">第七話　オープンワールドという泥沼</a></li>
</ul>



            
<hr style="margin-top: 200px;">

<div class="snsbuttons">

    <!-- Twitter -->
    <a href="https://twitter.com/share" class="twitter-share-button" data-related="cubbit2">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

    <!-- Hatena -->
    <div>
        <a href="http://b.hatena.ne.jp/entry/" class="hatena-bookmark-button" data-hatena-bookmark-layout="basic-label-counter" data-hatena-bookmark-lang="ja" title="このエントリーをはてなブックマークに追加"><img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" /></a><script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
    </div>

    <!-- line -->
    <div>
        <div class="line-it-button" style="display: none;" data-type="share-a" data-lang="ja" ></div>
        <script src="//scdn.line-apps.com/n/line_it/thirdparty/loader.min.js" async="async" defer="defer" ></script>
    </div>

    <!--facebook -->
    <div>
        <div id="fb-root"></div>
        <script>(function(d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s); js.id = id;
        js.src = "//connect.facebook.net/ja_JP/sdk.js#xfbml=1&version=v2.8";
        fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));</script>
        <div class="fb-like" data-href="https://aratama.github.io/blog/${metadata.id}.md" data-layout="button_count" data-action="like" data-size="small" data-show-faces="true" data-share="false"></div>
    </div>

    <!-- google+ -->
    <div>
        <script src="https://apis.google.com/js/platform.js" async defer>
        {lang: 'ja'}
        </script>
        <div class="g-plusone" data-size="medium"></div>
    </div>

</div>

        </article>
    </div>

<footer>
    <div class="block-centered footer-inner">
        <p class="copy">&nbsp;</p>
        <p class="author">このブログを書いてる人:&nbsp;&nbsp; <a target="_blank" href="https://twitter.com/cubbit2">兎沢</a><p>
    </div>

    <script>
        const poem = [
            "なんにもない毎日が、なによりの宝物。",
            "今日という日を、何度でも繰り返したい。",
            "世界を追いかけなくても、世界は私のまわりにある。", 
            "速すぎる雑踏。鼻先をくすぐる春風。", 
            "明日の写真を飾る場所を、アルバムに空けておこう。", 
            "落ち葉が地面に、触れる音がした。", 
            "明日は、明日の楽しさが待っている。", 
            "風が泣いている。この想いを紡ぐ言葉を持たないから。", 
            "もうここには何もない。はじまりの時が来た。"
        ];
    document.querySelector(".copy").textContent = poem[Math.floor(poem.length * Math.random())];
    </script>
</footer>

