<!DOCTYPE html>
<meta charset="UTF-8">

<!-- Twitter card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@cubbit2">
<meta name="twitter:creator" content="@cubbit2">
<meta name="twitter:title" content="【短編ポエム】Haskell/PureScriptの関数呼び出しはRuby/Python/JavaScriptよりイケている - ちょっと小さいのはたしかですが。">
<meta name="twitter:description" content="わたしのブログです。面白いかどうかは、わかりませんが。">
<meta name="twitter:image" content="https://aratama.github.io/res/empty.png">

<link rel="icon" type="image/png" href="icon.png">
<link rel="stylesheet" href="/res/reset.css">
<link rel="stylesheet" href="/res/style.css">

<title>【短編ポエム】Haskell/PureScriptの関数呼び出しはRuby/Python/JavaScriptよりイケている - ちょっと小さいのはたしかですが。</title>

<header>
    <div class="block-centered">
        <div class="site-title"><a href="/">ちょっと小さいのはたしかですが。</a></div>
        <div class="sub-title">わたしのブログです。面白いかどうかは、わかりませんが。</div>
    </div>
</header>



<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

<!--
<link rel="stylesheet" href="/lib/highlight/styles/default.css">
<script src="/lib/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
-->

<!--
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$']]}
});
</script>
-->


<link rel="stylesheet" href="/res/article.css">


    <div class="content">

        <article id="rendered">
            <div class="date">2016年9月22日</div>
            <h1 class="article-title">
                <!-- <i class="fa fa-coffee" aria-hidden="true"></i> -->
                <a href="6c82aeb99476c5917783.html">【短編ポエム】Haskell/PureScriptの関数呼び出しはRuby/Python/JavaScriptよりイケている<a>
            </h1>        
            <p class="tags"><a href="Ruby.html"><span class="tag"><i class="fa fa-tag" aria-hidden="true"></i>Ruby</span></a>
<a href="Python.html"><span class="tag"><i class="fa fa-tag" aria-hidden="true"></i>Python</span></a>
<a href="JavaScript.html"><span class="tag"><i class="fa fa-tag" aria-hidden="true"></i>JavaScript</span></a>
<a href="Haskell.html"><span class="tag"><i class="fa fa-tag" aria-hidden="true"></i>Haskell</span></a>
<a href="ポエム.html"><span class="tag"><i class="fa fa-tag" aria-hidden="true"></i>ポエム</span></a></p>
            <hr>
            <!-- {
  "id": "6c82aeb99476c5917783",
  "created_at": "2016-09-22T18:40:56+09:00",
  "tags": [
    {
      "name": "Ruby",
      "versions": []
    },
    {
      "name": "Python",
      "versions": []
    },
    {
      "name": "JavaScript",
      "versions": []
    },
    {
      "name": "Haskell",
      "versions": []
    },
    {
      "name": "ポエム",
      "versions": []
    }
  ],
  "title": "【短編ポエム】Haskell/PureScriptの関数呼び出しはRuby/Python/JavaScriptよりイケている"
} -->
<ul>
<li><a href="/blog/http://qiita.com/ocadaruma/items/4c66422cb7761f99e0fe.html">「Rubyのここがイケてない」を論破したい</a></li>
</ul>
<blockquote>
<p>Proc#callがださい</p></blockquote>
<p>たとえば、ふたつの引数の和を出力する関数<code>add</code>や<code>sum</code>について考えてみます。PythonやJavaScriptなら次のようなコードを書くことができます。</p><pre><code class="py">def add(x, y):
    print(x + y)

sum = add    # そのまま代入できる

add(1, 2) 
sum(1, 2)    # addとsumの呼び出し方に違いはない</code></pre><pre><code class="js">function add(x, y){
    console.log(x + y);
}

sum = add    // そのまま代入できる

add(1, 2) 
sum(1, 2)    // addとsumの呼び出し方に違いはない</code></pre><p>しかし、Rubyではメソッドをそのまま他の変数に代入したりはできず、<code>proc</code>や<code>lambda</code>で<code>Proc</code>オブジェクトを作ってから渡さなければなりませんし、受け取った側も<code>call</code>をつかって呼ぶ必要があります。これは<code>apply</code>メソッドを呼ばなければならないJavaあたりでも同じですね。</p><pre><code class="ruby">def add(x, y)
    puts (x + y)
end

sum = proc{|x, y| add(x, y)}  # procやlambdaで包む必要がある

add 1, 2          
sum.call 1, 2                 #callで呼び出す必要があり、addとsumの使い方が異なってしまう</code></pre><p>なるほどこれはダサい。でもこれにはRuby側の反論もあって、Rubyでは引数がないときはメソッド呼び出しで括弧を省略できるという利点もあります。</p><pre><code class="js">function answer(){
    console.log(42)
}

answer()        // 括弧がいる</code></pre><pre><code class="ruby">def answer
    puts 42
end

answer            # 括弧がいらない</code></pre><blockquote>
<p>私もちょっとダサい、っつーか扱い辛いと感じることがあります。が、これは文中にも書いてある通り、Rubyに価値を与えている独特なスタイルとのトレードオフでしょう。</p></blockquote>
<p>JavaScriptやPythonにこのような括弧の省略を導入しようとしても、関数オブジェクトそのものを表す構文と衝突してしまうので不可能です。そんなわけで、これを見る限り必ずしもどちらがいいと言い切れないようにみえるのですが……。</p><h1><a name="haskell-purescript-" class="anchor" href="#haskell-purescript-"><span class="header-link"></span></a>Haskell/PureScriptでは</h1><p>Haskell/PureScriptでは、このジレンマが解決します。</p><pre><code class="haskell">add x y = logShow (x + y)    -- addには引数があります

sum = add                    -- 関数は第一級なので、普通に代入できます

answer = logShow 42          -- answerには引数がありません

fortyTwo = answer           -- answerの値も第一級なので、そのまま別の変数に代入することもできます

main = do
    add 1 2                  -- 3が出力されます。引数がある場合はもちろん普通に呼び出せます
    sum 1 2                  -- 3が出力されます。addとsumに呼び出しかたの違いはありません
    answer                   -- 42が出力されます。引数がない場合も、もちろん括弧はありません
    fortyTwo                 -- 42が出力されます。fortyTwoとanswerは同じものを指しているからです</code></pre><p>Rubyの『引数のない関数呼び出しで括弧を省略できる』という利点と、Python/JavaScriptの『通常の関数呼び出しと、関数オブジェクトの呼び出しを区別しない』という利点の、ふたつの利点が両立しています。ふしぎ！Haskell/PureScriptでは何故こんなことができるのか、上のコードの各部はどういう意味なのか、どんな順序で実行が進んでいくのか、自分で考えてみると面白いかもしれません<a class="link-footnote" href="#footnote-sample" name="link-sample">※</a>。</p><p>それに、上のPureScriptのコードを良く見ると、ピリオドもなければコロンもないし、カンマのひとつすら存在しません。予約語はコードブロックの始まりを告げる<code>do</code>のみ。Pythonのようにインデントでブロックが表現されているなど、異様なまでにコードの見た目がスッキリしているのがわかると思います。これもHaskell/PureScriptのコードの特徴です。極限まで構文上のノイズが絞られていて筆者はすごく読みやすいと思うのですが、何故か読みにくいと言われることもあります。</p><blockquote>
<p>これは文法の問題なので、もしかしたらこれらを両立させる文法をもった言語が将来開発されるかもしれません。</p></blockquote>
<p>15年以上前からあります。使っている人が少なすぎて、あまり知られていませんが……。</p><p>引数がないときの括弧を省こうとするなど、Rubyを使う人はそういう構文上のオーバーヘッドを嫌う人が多いのかもしれません。Haskell/PureScriptはとにかく構文が簡潔ですから、Rubyが好きな人にも向いているんじゃないかと。このような細かいところは正直どうでもいいと私は思うのですが、私は普段『同期的な作用と非同期な作用をモナドで抽象化すると一貫性が生まれて便利だよ』みたいな重大なポイントについて利点の説明をしては『意味わかんねーよ文章長えよカス！』という感じで罵られているので、今回は『関数の引数の有無や第一級かどうかについて便利さと単純さが両立するよ』という、わかりやすいポイントについてなるべく簡潔に説明をしました。</p><hr>
<p class="footnote"><a href="#link-sample" name="footnote-sample">^</a>  もっとも、Haskell/PureScriptを知らない人は絶対にわからないと思いますが。なお、これはPureScriptのコードなので、実行の順序がぐちゃぐちゃになるHaskell特有の変態仕様『遅延評価』は関係がありません</p>
            
<hr style="margin-top: 200px;">

<div class="snsbuttons">

    <!-- Twitter -->
    <a href="https://twitter.com/share" class="twitter-share-button" data-related="cubbit2">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

    <!-- Hatena -->
    <div>
        <a href="http://b.hatena.ne.jp/entry/" class="hatena-bookmark-button" data-hatena-bookmark-layout="basic-label-counter" data-hatena-bookmark-lang="ja" title="このエントリーをはてなブックマークに追加"><img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" /></a><script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
    </div>

    <!-- line -->
    <div>
        <div class="line-it-button" style="display: none;" data-type="share-a" data-lang="ja" ></div>
        <script src="//scdn.line-apps.com/n/line_it/thirdparty/loader.min.js" async="async" defer="defer" ></script>
    </div>

    <!--facebook -->
    <div>
        <div id="fb-root"></div>
        <script>(function(d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s); js.id = id;
        js.src = "//connect.facebook.net/ja_JP/sdk.js#xfbml=1&version=v2.8";
        fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));</script>
        <div class="fb-like" data-href="https://aratama.github.io/blog/${metadata.id}.md" data-layout="button_count" data-action="like" data-size="small" data-show-faces="true" data-share="false"></div>
    </div>

    <!-- google+ -->
    <div>
        <script src="https://apis.google.com/js/platform.js" async defer>
        {lang: 'ja'}
        </script>
        <div class="g-plusone" data-size="medium"></div>
    </div>

</div>
        </article>
    </div>

<footer>
    <div class="block-centered footer-inner">
        <p class="copy">&nbsp;</p>
        <p class="author">このブログを書いてる人:&nbsp;&nbsp; 兎沢<p>
    </div>

    <script>
        const poem = [
            "なんにもない毎日が、なによりの宝物。",
            "今日という日を、何度でも繰り返したい。",
            "世界を追いかけなくても、世界は私のまわりにある。", 
            "速すぎる雑踏。鼻先をくすぐる春風。", 
            "明日撮る写真を飾る場所を、アルバムに空けておこう。", 
            "落ち葉が地面に、触れる音がした。", 
            "明日は、明日の楽しさが待っている。", 
            "風が泣いている。この想いを紡ぐ言葉を持たないから。", 
            "もうここには何もない。つまり、はじまりの時が来た。", 
            "もう此処にはこないだろう。そう言って私は過去に背を向けた。", 
            "散りゆくからこそ、美しい。私は桜の花びらをかかとで踏みしめた。", 
            "思い出はいつだって輝いてる。",
            "正直ばかりじゃつまらない。たまには楽しい嘘をつこう。", 
            "ゆっくり歩けば歩くほど、時間がゆっくり過ぎてゆく。",
            "夜明けを、探しにいこう。"
        ];
    document.querySelector(".copy").textContent = poem[Math.floor(poem.length * Math.random())];
    </script>
</footer>

